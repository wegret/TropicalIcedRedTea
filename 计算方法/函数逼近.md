[TOC]



# 函数逼近

## 引入：函数逼近？

插值法要求在插值节点上误差为零，也就是插值函数要过插值点。但是逼近不需要，逼近法只需要定义一个区间上的误差度量方法，然后求逼近函数$p(x)$，使得$p(x)$和$f(x)$的误差在这种度量方法下最小即可。

很显然，只要是连续函数，就可以用多项式逼近。

如何获得逼近函数$P(x)$呢？一个简单的思路是从一类基础函数中挑出一堆，然后线性组合起来，很类似插值法的思路。

## 基本概念

### 范数

前面已经提了，逼近法需要定义一个在区间上的误差的度量方式。因此引入范数的概念，用来在后面衡量逼近的误差。

范数可以被定义在向量上，也可以被定义在连续函数空间上（我们可以将连续函数空间视为无限维的向量）。

#### 范数的性质

设$S$为线性空间，$x\in S$，若存在唯一实数$||\cdot||$，满足条件：
① （正定性，都大等于0）$||x||\geq 0$，且当且仅当$x=0$时取等。
② （齐次性，可以提取因子）$||ax||=|\alpha|\cdot ||x||$
③ （三角不等式）$||x+y||\leq ||x||+||y||,x,y \in S$

就可以将$||\cdot||$记为线性空间$S$上的范数。

#### 范数的类型

有几种比较常用的范数，先来看一下定义在向量上的。对于$R^n$上的向量，有三种常用范数：

① ∞-范数或最大范数：$||x||_\infty=\max_{1\leq i\leq n}|x_i|$，也就是各维上的绝对值最大值

② 1-范数：$||x||_1=\sum_{i=1}^n |x_i|$，也就是各维度的绝对值累加

③ 2-范数：$||x||_2=\sqrt{\sum_{i=1}^n x_i^2}$，各维度距中心的距离。

上述都是定义在向量上的。连续函数可以视为无限维的向量，因此很容易把概念推广到函数上：

① ∞范数：$||f||_\infty =\max_{a\leq x\leq b}|f(x)|$，也就是区间上的最大绝对值函数值

② 1-范数：$||f||_1 =\int _a^b |f(x)|dx$，也就是区间上函数的绝对值积分

③ 2-范数：$||f||_2=\sqrt{\int_a^b f^2(x) dx}$

### 内积

在线性代数中，两个$n$维向量$\textbf{x}=(x_1,x_2,...,x_n)^T$和$\textbf{y}=(y_1,y_2,...,y_n)^T$的内积定义为
$$
(x,y)=x_1y_1+x_2y_2+...+x_ny_n
$$
这是线性代数中很基础的概念。为什么在函数逼近中要引入这个？因为内积可以作为投影和一个方向量的乘积，可以用来在正交化中去除某个维度的分量。

很明显，如果把函数视为无限维的向量，那就可以得到函数的内积
$$
(f,g)=\int_{a}^b f(x)\cdot g(x) dx
$$
除此之外，还可以推广出带权内积
$$
(f,g)=\int_a^b \rho(x)\cdot f(x)\cdot g(x)dx
$$
推广到一般的线性空间，我们称$(u,v)$为线性空间$X$上的内积，当且仅当满足以下四个条件时（交换性、可提因子、线性可加，大等于0）：

① $(u,v)=\overline{(v,u)}$，（后者是前者的共轭，在$X$是实数$R$上的线性空间时，这里是$(u,v)=(v,u)$）

 ② $(\alpha u,v)=\alpha(u,v)$，（可以提取因子）

 ③ $(u+v,w)=(u,w)+(v,w)$，（线性可加）

 ④ $(u,u)\geq 0$，当且仅当$u=0$时，$(u,u)=0$

**正交** 如果$(u,v)=0$，那么称$u$、$v$二者正交，这个是向量相互垂直概念的推广。

内积还有一些其他的定理：

**柯西-施瓦茨不等式** $|(u,v)|^2 \leq (u,u)(v,v)$

**格拉姆矩阵非奇异条件** 矩阵
$$
G=\begin{bmatrix}
(u_1,u_1) & (u_2,u_1) & ... & (u_n,u_1)\\
(u_1,u_2) & (u_2,u_2) & ... & (u_n,u_2)\\
\vdots & \vdots & & \vdots\\
(u_1,u_n) & (u_2,u_n) & ... & (u_n,u_n)
\end{bmatrix}
$$
被称为格拉姆矩阵，它非奇异（满秩）的充分必要条件是$u_1$、$u_2$、...、$u_n$线性无关。

格拉姆矩阵是一种特殊的矩阵，它编码了一组向量或函数之间的内积信息。格拉姆矩阵不仅反映了这些向量的长度（或者函数的范数），还反映了它们之间的夹角（在函数的情况下，可以理解为它们的相似度），同时联系了这一组向量或函数的线性相关性和内积的关系。

格拉姆矩阵，经常被用来证明一组函数线性无关。

------

**例题**：证明函数$1,x,...,x^n$线性无关。

要证明线性无关，只需要证明$a_0+a_1x+...+a_nx^n=0$仅有零解，也就是$\mathbf{a}=\begin{bmatrix}0\\0\\\vdots\\0\end{bmatrix}$

选择区间$[0,1]$上，考虑用格拉姆矩阵来证明线性无关。定义
$$
(x^i,x^j)=\int_0^1 x^i x^j dx=\int_0^1x^{i+j}dx=\frac{1}{i+j+1} & i,j\in\{0,1,...,n\}\\
$$
格拉姆矩阵
$$
G=\begin{bmatrix}
1 & \frac{1}{2} & ... & \frac{1}{n+1}\\
\frac{1}{2} & \frac{1}{3} & ... & \frac{1}{n+2}\\
\vdots & \vdots & & \vdots\\
\frac{1}{n+1} & \frac{1}{n+2} & ... & \frac{1}{2n+1}
\end{bmatrix}
$$
这个矩阵是希尔伯特矩阵，因此非奇异，线性无关得证。

**例题**：对于$f(x),g(x)\in C^1[a,b]$，问$(f,g)=\int_a^b f'(x)g'(x)\text{dx}$是否构成内积？

要判断是否构成内积，只需要检验内积的四个性质即可。

① 交换性，$(f,g)=(g,f)$显然成立。

② 提取因子，$(cf,g)=c(f,g)$显然成立。

③ 线性可加，$(f_1+f_2,g)=(f_1,g)+(f_2,g)$显然成立。

④ $(f,f)=\int_a^b(f'(x))^2 dx\geq 0$，当且仅当在$f'(x)=0$时取等，但此时$f$未必为零，因此不符合第四条性质，不能构成内积。

------

### 正交函数

前面已经提过了，函数带权内积的定义是
$$
(f,g)=\int_a^b \rho(x)\cdot f(x)\cdot g(x)dx
$$
也提过，正交的定义是内积为0。那现在可以定义出**函数带权正交**的定义
$$
(f,g)=\int_a^b \rho(x)\cdot f(x)\cdot g(x)dx=0
$$
如果有一堆函数（称为函数族）$\varphi_0(x),\varphi_1(x),...,\varphi_n(x),...$，满足：任意的两个不同函数之间的带权内积为0，且自己和自己的内积是非零常数，也就是
$$
(\varphi_j,\varphi_k)=\int_a^b \rho(x)\varphi_j(x)\varphi_k(x)dx=\begin{cases}
0 & j\neq k\\
A_k>0&j=k
\end{cases}
$$
就把这一堆函数称为**正交函数族**。

特殊情况是每个函数自己和自己的内积恒为1，也就是$A_k\equiv 1$，那就称为**标准正交函数族**。

如果这里特殊化地，只考虑多项式函数，且我们让这堆函数$\varphi_0(x),\varphi_1(x),...,\varphi_n(x),...$中，每个$\varphi_k$都是首项系数不为0的$k$次多项式，例如$1,x,x^2,...,x^n$，就是满足要求的多项式序列。

我们给定这样一个多项式序列，并且定义$[a,b]$上的权函数$\rho(x)$，假设这个多项式序列$\{\varphi_n(x)\}_0^\infty$满足上述的正交关系，我们就称这个多项式序列为$[a,b]$上带权$\rho(x)$的**$n$次正交多项式**。

在线性代数，已经学过了如何用施密特正交化求标准正交向量。现在来看一下如何求得正交多项式。我们已经有了一组非常显然的线性无关的多项式：
$$
1,x，x^2,...,x^n
$$
如何通过这组线性无关的多项式，求得正交多项式？考虑用递推公式
$$
\varphi_{n+1}(x)=(x-\frac{(x\varphi_n,\varphi_n)}{(\varphi_n,\varphi_n)})\varphi_n-\frac{(\varphi_n,\varphi_n)}{(\varphi_{n-1},\varphi_{n-1})}\varphi_{n-1}
$$
这个公式怎么理解？可以从头推一遍。从第一个多项式开始
$$
\varphi_0(x)=1
$$
假设我们已经得到了前面的一堆正交多项式$\varphi_0(x),\varphi_1(x),...,\varphi_n(x)$，现在要来构造$\varphi_{n+1}(x)$，一个很显然的思路是，先扩展到$n+1$维，然后再剪掉其他维的分量。扩展到$n+1$维很简单，直接$(x\varphi_n)$就得到了$n+1$维。
$$
p_{n+1}(x)=x\cdot \varphi_n(x)
$$
这里乘以$x$的操作，类似于向量中的升维，或者说，例如对$[0,1,2,0]$这个向量做线性变换
$$
\begin{pmatrix}&&&1\\ \:1&&&\\ \:&1&&\\ \:&&1&\end{pmatrix}\begin{pmatrix}\\ \:1\\ \:2\\ \:\end{pmatrix}=\begin{pmatrix}\\ \\ 1\\ 2\end{pmatrix}
$$
直接提到更高的维度。因此$p_{n+1}(x)$它天然具有第$n+1$维分量，但是也具有其他维度的一些杂乱的分量。我们需要对它进行去除在之前正交多项式上的投影，朴素的方法，是一维一维地去除
$$
\varphi_{n+1}(x)=p_{n+1}(x)-\sum_{i=0}^n \frac{(p_{n+1},\varphi_i)}{(\varphi_i,\varphi_i)}\varphi_i(x)
$$
这种方法肯定不优，每次增加一个向量都要遍历前面的所有向量，时间复杂度到$O(n^2)$了。能不能进行优化？

肯定可以，我们还有信息没有用上，就是已知的正交性。我们知道$p_{n+1}(x)$是由$\varphi_{n}(x)$做一个乘积或者说类似矩阵位移得到的，$\varphi_{n}(x)$是完全是第$n$维的向量，因此$x\varphi_{n}(x)$中，部分低阶项是不存在的。我们只需要确保$\varphi_{n+1}(x)$与$\varphi_n(x)$、$\varphi_{n-1}(x)$正交即可。直接剪掉在这两个方向上的投影
$$
\varphi_{n+1}(x)=p_{n+1}(x)-\frac{(p_{n+1},\varphi_n)}{(\varphi_n,\varphi_n)}\varphi_n-\frac{(\varphi_n,\varphi_n)}{(\varphi_{n-1},\varphi_{n-1})}\varphi_{n-1}
$$
上述是一个通用的构造正交多项式序列的方法，但是不同的权函数下的内积定义不同，区间也不同，所以构造出来的正交多项式也是不同的。

为什么要构建正交多项式？在函数逼近中，复杂函数展开为一系列简单多项式的和来近似解决。正交多项式因其正交性质，在这种展开中特别有效，因为它们能够最小化近似误差，每一个多项式都独立地贡献于总的函数表示，减少了项与项之间的冗余。

### 最佳逼近

给定函数$f(x)\in C[a,b]$，求它的最佳逼近多项式。

**最佳逼近多项式**       若$P^*(x)\in H_n$（这里$H_n$是指$span\{1,x,x^2,...,x^n\}$，也就是幂函数线性组合的线性空间），误差$||f(x)-P^*(x)||=\min _{P\in H_n}||f(x)-P(x)||$，这个能取到最小误差的$P^*(x)$就是$f(x)$在$[a,b]$上的最佳逼近多项式。

**最佳逼近函数**           上面的$H_n$是幂函数的线性空间，如果不要求幂函数，取$P(x)\in \Phi =span\{\varphi_0,\varphi_1,...,\varphi _n\}$，这时候对应的$P^*(x)$就是最佳逼近函数。

这里的范数$||\cdot ||$通常是$||\cdot ||_\infty$（无穷范数，误差最大的那个点的误差），或者$||\cdot ||_2$（2-范数，也就是总误差的平方开根）。

**最优一致逼近多项式**（即最大误差最小的多项式）      选择$||\cdot ||_\infty$作为范数时，此时$||f(x)-P^*(x)||_\infty=\min _{P\in H_n}|f(x)-P(x)|$

**最佳平方逼近多项式**（即误差平方的总积分最小的多项式）      选择$||\cdot ||_2$作为范数时，此时$||f(x)-P^*(x)||_2^2=\min _{P\in H_n}\int_a^b [f(x)-P(x)]^2 dx$（注意这里等式左边是取了平方的）

根据Weierstrass定理，最优一致逼近多项式的误差随着$n$增大而单调下降，趋近于0。

**最小二乘拟合**                  若$f(x)$是$[a,b]$上的一个列表函数，也就是说是离散的无法积分，在$a\leq x_0<x_1<...<x_m\leq b$上给出$f(x_i)(i=0,1,...,m)$，要求$P^*\in \Phi$使得$||f-P^*||_2=\min_{P\in \Phi}||f-P||_2=\min _{P\in \Phi} \sum_{i=0}^m [f(x_i)-P(x_i)]^2$，这时候称$P^*(x)$为$f(x)$的一个最小二乘拟合。



## 一. 最佳一致逼近（切比雪夫逼近）

最佳一致逼近，就是使得给定区间上，拟合函数的最大误差最小化的多项式。在计算这个多项式时，通常采用切比雪夫多项式。为什么？

### 切比雪夫多项式？

先来看一下切比雪夫多项式是什么。切比雪夫是权函数为$\rho(x)=\frac{1}{\sqrt{1-x^2}}$，区间为$[-1,1]$下的一个正交多项式。这可以写成一个公式：
$$
T_n(x)=\cos (n \arccos x), \space -1\leq x\leq 1
$$
这看上去很复杂，但是实际上，利用一些三角恒等式，可以很容易逐项推导出下面的式子：

$T_0=1$

$T_1=x$

$T_2=2x^2-1$

$T_3=4x^3-3x$

$T_4=8x^4-8x^2+1$

……

<iframe src="https://www.desmos.com/calculator/a7vo9mjq0v?embed" width="300" height="300" style="border: 1px solid #ccc" frameborder=0></iframe>

可以看出，$T_n$具有$n-1$个极值点（小性质）。

上述是满足一个递推式的，即：
$$
T_{n+1}=2xT_n-T_{n-1}
$$
因此，只需要记住前两项$T_0,T_1$，就可以利用递推式得到所有的切比雪夫多项式的基了。

很容易发现，$T_n$的最高次项的系数是$2^{n-1}$，并且任意一个$T_k$都满足$|T_k|\leq 1$

很显然，切比雪夫多项式的每一项都是与前面的所有正交的，需要注意这里的权函数是$\rho (x)=\frac{1}{\sqrt{1-x^2}}$而不是$1$，不过在做计算题时权函数大多数时无关紧要。

------

**例题**：令$T_n^*(x)=T_n (2x-1),x\in[0,1]$，试证$\{T_n^*(x)\}$是在$[0,1]$上带权$\rho(x)=\frac{1}{\sqrt{x-x^2}}$的正交多项式，并求$T_0^*(x),T_1^*(x),T_2^*(x),T_3^*(x)$。
$$
\int_{-1}^1\frac{1}{\sqrt{1-t^2}}\cdot T_i(t)\cdot T_j(t)dt=0
$$
从$t$投影出$x$。$t\in[-1,1]$，$x=\frac{1}{2}(t+1)\in [0,1]$

也就是
$$
t=2x-1
$$
代入原式
$$
\int_0^1 \frac{1}{\sqrt{1-(2x-1)^2}}T_i(2x-1)T_j(2x-1)dx=0
$$
整理
$$
\int_0^1\frac{1}{\sqrt{x-x^2}}T_i^*(x)T_j^*(x)dx=0
$$
得证。

**例题**：对权函数$\rho(x)=1+x^2$，区间$[-1,1]$，试求首项系数为1的正交多项式$\varphi_n(x),n=0,1,2,3$

$\varphi_0(x)=1$

$\varphi_1(x)=x$

$\varphi_2(x)=x^2-\frac{(x^2,x)}{(x,x)}x-\frac{(x,x)}{(1,1)}\times 1=x^2-\frac25$

$\varphi_3(x)=x(x^2-\frac25)-\frac{(x(x^2-\frac25),x^2-\frac25)}{(x^2-\frac25,x^2-\frac25)}(x^2-\frac25)-\frac{(x^2-\frac25,x^2-\frac25)}{(x,x)}x\\=x^3-\frac{9}{14}x$

------



### 最佳一致逼近

为什么用切比雪夫多项式来做误差最大值最小化的一致逼近？从理解上，因为切比雪夫多项式在$[-1,1]$上的极值点均匀分布，尽可能均匀了最大误差，使得最大误差最小。

从严格意义上，因为切比雪夫多项式有一个性质：设$\tilde{T_n}(x)$是首项系数为$1$的切比雪夫多项式，则在区间$[-1,1]$s上，有$\max |\tilde{T_n}(x)|\leq \max|P(x)|,\space \forall P(x)\in \tilde{H_n}$

这句话意思就是说，首项系数为$1$（也就是整体除以$2^{n-1}$了）的切比雪夫多项式，绝对值的最大值（其实就是$\frac{1}{2^{n-1}}$！因为任意的$T_k$最大振幅都是$1$）比任何一个首项系数为$1$的$n$次多项式的绝对值的最大值都小，后面这个$P(x)$可以视为$x^n+ax^{n-1}+...$.。

这个定理的证明略了，总之，把$T_n(x)$按一定比例缩放，是所有首项系数相同的$n$次多项式中，最大值最小的。

利用这个结论，可以求$n$次多项式$P(x)$的不超过$n-1$次的最佳一致逼近多项式。这又是为什么？我们需要用一个$n-1$次的$P^*(x)$去逼近$P(x)$，使得$\max |P(x)-P^*(x)|$最小，这是在什么情况下最小呢？我们知道，对于所有首项系数相同的$n-1$次多项式，按一定比例缩放后的切比雪夫多项式，是绝对值的最大值最小的。而$|P(x)-P^*(x)|$，我们知道它的首项次数是给定的，就等于$P(x)$的首项系数（因为只有$P(x)$有$n$次项，$P^*(x)$最高只有$n-1$次），那么，$|P(x)-P^*(x)|$最小，也就是当$P(x)-P^*(x)$等于一个按一定比例的切比雪夫多项式的时候了。

不过实际上很多时候题目中给定的区间并不是$[-1,1]$，就需要做一个映射，其余均一致。

------

**例题**：求$f(x)=2x^3+x^2+2x-1$在$[-1,1]$上的最佳二次逼近多项式。

由题意，所求的$P_2^*(x)$，应满足
$$
\max_{-1\leq x\le 1}|f(x)-P_2^*(x)|=\min
$$
由前面的定理知道，要用二次多项式来逼近一个三次的原函数，误差肯定是三次的，也就是是说$|f(x)-P_2^*(x)|$是三次的，并且首项系数确定了肯定是$2$（因为$P_2^*$不能提供三次项）。要让$|f(x)-P_2^*(x)|$这个首项系数是$2$的3次多项式在区间$[-1,1]$上最小，根据`切比雪夫多项式比任何一个首项系数相同的多项式的绝对值的最大值都小`这个性质，直接引入切比雪夫多项式
$$
f(x)-P_2^*(x)=2\times\tilde{T_3}
$$
也就是
$$
f(x)-P_2^*(x)=\frac{1}{2}(4x^3-3x)=2x^3-\frac32x\\
P_2^*(x)=x^2+\frac72x-1
$$
前面这题是区间直接处于$[-1,1]$了，但是实际中许多问题并非如此，例如下面这题。

**例题**：求$f(x)=x^4+3x^3-1$在区间$[0,1]$上的三次最佳一致逼近多项式。

首先发现这个区间不是$[-1,1]$，那需要做映射了
$$
2x-1=t
$$
问题变成了$f(\frac{t+1}{2})=g(t)=(\frac{t+1}{2})^4+3(\frac{t+1}{2})^3-1$

这里要最佳一致逼近，则
$$
g(t)-P_3^*(t)=\frac{1}{128}\times(8t^4-8t^2+1)\\
$$
后面步骤同理。

------



## 二. 最佳平方（勒德让多项式）

最佳平方逼近，就是使得给定区间上，拟合函数的误差平方积分最小化的多项式。

朴素的方法求最佳平方逼近多项式。假设我们用一组线性无关的$\varphi_0,\varphi_1,\varphi_2...$做基，在区间$[a,b]$上，要求最佳逼近多项式，设其为
$$
S^*(x)=a_0^*+a_1^*x+a_2^*x^2+...+a_n^*x^n
$$
要求设置参数，使得
$$
I(a_0,a_1,...,a_n)=\int_a^b \rho(x)\left[ \sum_{j=0}^n a_j\varphi_j(x)-f(x) \right]^2dx =\min
$$
这是一个多元函数极值问题，经过一些推导，我们最后其实就是在求解下列的法方程
$$
\left[
\begin{array}{cccc}
(\varphi_0, \varphi_0) & (\varphi_0, \varphi_1) & \cdots & (\varphi_0, \varphi_n) \\
(\varphi_1, \varphi_0) & (\varphi_1, \varphi_1) & \cdots & (\varphi_1, \varphi_n) \\
\vdots                 & \vdots                 & \ddots & \vdots                 \\
(\varphi_n, \varphi_0) & (\varphi_n, \varphi_1) & \cdots & (\varphi_n, \varphi_n) \\
\end{array}
\right]
\left[
\begin{array}{c}
a_0 \\
a_1 \\
\vdots \\
a_n \\
\end{array}
\right]
=
\left[
\begin{array}{c}
(f, \varphi_0) \\
(f, \varphi_1) \\
\vdots \\
(f, \varphi_n) \\
\end{array}
\right]
$$
这是一个格拉姆矩阵，因为我们选的基函数肯定是线性无关的，所以系数矩阵满秩，有唯一解。

根据前面的方式，我们如果把误差写作$f(x)-S^*(x)$，平方误差其实就是
$$
\begin{aligned}
||\delta(x)||_2^2&=(f(x)-S^*(x),f(x)-S^*(x))\\
&=(f(x),f(x))-(S^*(x),S^*(x))
\end{aligned}
$$

------

**例题**：设$f(x)=\sqrt{1+x^2}$，求$[0,1]$上的最佳一次平方逼近多项式。

我们直接拿$1,x$做基函数，直接去求解上述的法方程。

$(\varphi_0,\varphi_0)=1$，$(\varphi_0,\varphi_1)=1/2$，$(\varphi_1,\varphi_1)=1/3$

$(f,\varphi_0)$等再求出来，代入上式求解方程即可。

------

从上述的例题可以看出来，这个矩阵求解还是挺麻烦的，有没有什么优化的方式？很容易发现，只需要我们选取的基函数正交即可。如果不同的基函数正交，我们的矩阵就可以变成这样：
$$
\left[
\begin{array}{cccc}
(\varphi_0, \varphi_0) &  &  &  \\
& (\varphi_1, \varphi_1) &  &  \\
                &              & \ddots &   \\
&  &  & (\varphi_n, \varphi_n) \\
\end{array}
\right]
\left[
\begin{array}{c}
a_0 \\
a_1 \\
\vdots \\
a_n \\
\end{array}
\right]
=
\left[
\begin{array}{c}
(f, \varphi_0) \\
(f, \varphi_1) \\
\vdots \\
(f, \varphi_n) \\
\end{array}
\right]
$$
很明显这个就很好算，因此我们需要对区间$[-1,1]$上的$1,x,x^2,x^3,...$这组基进行正交化，也就是勒德让多项式。

### 勒德让多项式

**勒让德多项式**     当区间为$[-1,1]$，权函数$\rho(x)\equiv 1$时，由$\{1,x,x^2,...,x^n,...\}$正交化得到的多项式，是勒让德多项式。

最高项系数为$1$的勒让德多项式为：

$$\overset{\sim}{P}_n(x)=\frac{n!}{(2n)!}\frac{d^n}{dx^n}{(x^2-1)^n}$$

勒让德多项式具有性质：

① 正交性，$\int_{-1}^1P_n(x)P_m(x)=\begin{cases}0,&m\neq n \\\frac{2}{2n+1},&m=n \end{cases}$

② 奇偶性，$P_n(-x)=(-1)^n P_n(x)$

③ 递推关系，$(n+1)P_{n+1}(x)=(2n+1)xP_n(x)-nP_{n-1}(x)$

勒德让多项式最重要的是构造方法。

$P_0(x)=1$

$P_1(x)=x$

$P_2(x)=(3x^2-1)/2$

$P_3(x)=(5x^3-3x)/2$

$P_4(x)=(35x^4-30x^2+3)/8$

……

和切比雪夫多项式一样，其实只需要记忆前两项即可，后面的可以用递推公式：

$(n+1)P_{n+1}(x)=(2n+1)xP_{n}(x)-nP_{n-1}(x)$

<iframe src="https://www.desmos.com/calculator/hrwvbnsefi?embed" width="300" height="300" style="border: 1px solid #ccc" frameborder=0></iframe>

------

**例题**：求函数$f(x)=\sin{\frac{\pi}{2}x}$在$[-1,1]$上按勒德让多项式展开求三次最佳平方逼近多项式。

写出勒德让多项式：

$\varphi_0(x)=1$

$\varphi_1(x)=x$

$\varphi_2(x)=\frac32x^2-\frac12$

$\varphi_3(x)=\frac52x^3-\frac32x$

得到矩阵
$$
2\begin{bmatrix}
 1 &  &  & \\
  & 1/3 &  & \\
  &  & 1/5 & \\
  &  &  & 1/7
\end{bmatrix}
X=
\begin{bmatrix}
0\\
\frac{8}{\pi^2}\\
0\\
\frac{168(\pi^2-10)}{\pi^4}
\end{bmatrix}
$$
把这个矩阵算出来即可。

------

