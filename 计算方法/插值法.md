[TOC]



# 插值法

## 引入：什么是插值？

设未知函数$y=f(x)$在区间$[a,b]$上有定义，且已知过$n+1$个点$(x_0,y_0)$、$(x_1,y_1)$、...、$(x_n,y_n)$（其中所有的$x_i$均属于区间$[a,b]$，且互异并从小到大）。

**插值函数**  若存在一个简单函数$P(x)$，使得它能经过上述$n+1$个点，那么就称$P(x)$为$f(x)$。

**插值节点**     其中已知的那些$n+1$个点$x_i$，称为插值节点。
**插值区间**     区间$[a,b]$称为插值区间。
**插值多项式**   若插值函数$P(x)$是一个不超过$n$次的多项式，那么就称$P(x)$为插值多项式，即

$$P(x)=a_0+a_1x+...+a_nx^n$$

插值方法有多种：多项式插值、分段插值、三角插值。在《数值分析》第五版中，仅仅讨论了多项式插值和分段插值。

### 多项式插值

多项式插值中，实际上是在求解$n+1$元线性方程组：
$$
\begin{cases}
a_0+a_1x_0+a_2x_0^2...+a_nx_0^n= y_0 \\
a_0+a_1x_1+a_2x_1^2...+a_nx_1^n= y_1 \\
a_0+a_1x_2+a_2x_2^2...+a_nx_2^n= y_2 \\
\vdots& \\
a_0+a_1x_n+a_2x_n^2...+a_nx_n^n= y_n \\
\end{cases}
$$
系数矩阵是范德蒙德矩阵，
$$
\mathbf{A}=\begin{bmatrix}
1 & x_0 & ... & x_0^n\\
1 & x_1 & ... & x_1^n\\
\vdots & \vdots & & \vdots \\
1 & x_n & ... & x_n^n
\end{bmatrix}
$$
在线性代数中，我们已经学过，范德蒙德多项式秩非零的条件是所有$x_i$都互异，由前面的插值条件我们已经知道这个是满足的，所以可以证明，插值多项式$P(x)$是唯一的。

显然我们可以直接求解上述方程组来得到插值多项式$P(x)$，但是这是最差的方法一般不用的，有其他的插值方法。这一章大概就是讲如何求得这样的多项式。每种方法求得的多项式可能形式不同，我们只需要给出能进行计算的式子即可，无需化到最简。

## 一. 拉格朗日插值法

### 基函数？

我们可以注意到，求得的多项式$P(x)=a_0+a_1x+...+a_nx^n$，实际上是$n+1$维空间中以$1$、$x$、$x^2$、...、$x^n$为$n+1$个单项式基（monomial basis）的任意线性组合，或者说，每个单项式基（$x^k$）经过伸缩变换（乘以$a_k$）后的叠加。

但是我们可以不使用单项式基，可以选择不同的基，得到不同的表示方式，例如我们也可以选择多项式基，以$1$、$x$、$x^2-x$、$x^3-x$...来表示，不过选择不同的基前，必须保证它们是线性无关的。

拉格朗日插值，就是把这个多项式，写在不同的基下，这个基，被称为拉格朗日基函数。

如果使用单项式基，结果是比较不直观的，不太好方便地计算出系数。拉格朗日插值就很好地优化了这个问题，我们前面提到过，我们有$n+1$个点或者说插值节点，我们得到的插值函数必须经过这些点。我们还需要找$n+1$个（伸缩变换后的）基，它们叠加称为插值函数。

### 拉格朗日基函数

拉格朗日插值法的思想是，我们不如直接令第$i$个基（函数）（$i=0,1,2.,..,n$），它经过伸缩变化（乘以$a_i$）后，在第$i$个插值节点$x_i$处等于$y_i$，在其他插值节点处都等于0。这样显然$n+1$个各自经过不同$y_i$的插值基，累加后会经过所有点，满足插值函数的条件。

简单说，举个例子，例如，我们要对过$(-2,1)$，$(-1,3)$，$(0,-3)$，$(1,2)$，$(2,1)$这五个点，构造插值函数。插值节点分别是$-2,1,0,1,2$。

那构造出来的肯定是一个有4项的多项式函数。拉格朗日的思想就是，对于这4个项，我们要求，第1个项，在插值节点$1,0,1,2$上都是0，只有在$-2$上是$1$；第2个项，在插值节点$-2,0,1,2$上都是0，只有在$1$上是$3$。后面的同理，见后图。

如何构造？例如，我们先来构建第1项，要求在插值节点$1,0,1,2$上都是0，只有在$-2$上是$1$。要求是零，我们就直接写出$(x+1)(x-0)(x-1)(x-2)$，保证了第一个要求。然后要求在$-2$上是$1$，先把上式代入$x=-2$，得到是$24$。但是我们要求在$-2$上是$1$，那就对上式乘上一个缩放因子$\frac{1}{24}$，写作
$$
\frac{1}{24}(x+1)(x-0)(x-1)(x-2)
$$
类似下图：

<iframe src="https://www.desmos.com/calculator/qoqwnybfoj?embed" width="400" height="400" style="border: 1px solid #ccc" frameborder=0></iframe>

第一个构造完成。第二同理：

<iframe src="https://www.desmos.com/calculator/dd898pkxkl?embed" width="400" height="400" style="border: 1px solid #ccc" frameborder=0></iframe>

最后可以得到一整个长这样：

<iframe src="https://www.desmos.com/calculator/aclwstln1i?embed" width="500" height="500" style="border: 1px solid #ccc" frameborder=0></iframe>

全部叠加后，得到最终的插值函数：

<iframe src="https://www.desmos.com/calculator/0p8tycjdi7?embed" width="500" height="500" style="border: 1px solid #ccc" frameborder=0></iframe>

用数学语言来写，如何得到第$i$个基函数？

我们不妨设第$i$个基函数为$l_i(x)$，这个基函数要求过$(x_i,1)$，并且还过其余的$(x_j,0)$。也就是说：
$$
\begin{cases}
l_i(x_i)=1\\
l_i(x_j)=0 \\
\end{cases}
$$
既然我们已经知道过的$n+1$个点中有$n$个点都是零点，那我们直接可以设：

$$l_i(x)=c(x-x_0)(x-x_1)(x-x_2)...(x-x_n)$$

（注意，其中不包括$(x-x_i)$，因为在这个点不是零点；$c$是待确定的常数。）

这个式子有更严谨的写法：

$$l_i(x)=c(x-x_0)(x-x_1)(x-x_2)...(x-x_{i-1})(x-x_{i+1})...(x-x_n)$$

因为我们知道，基函数过$(x_i,1)$，因此$c$是已知的，有

$$c=\frac{1}{(x_i-x_0)(x_i-x_1)(x_i-x_2)...(x_i-x_{i-1})(x_i-x_{i+1})...(x_i-x_n)}$$

这样，我们就得到了一般形式下的拉格朗日基函数表达式：

 $$\begin{align} l_i(x)&=\frac{(x-x_0)(x-x_1)...(x-x_{i-1})(x-x_{i+1})...(x-x_n)}{(x_i-x_0)(x_i-x_1)...(x_i-x_{i-1})(x_i-x_{i+1})...(x_i-x_n)} \\ &=\prod_{k=0,k\neq j}^n\frac{x-x_k}{x_i-x_k} \\ &=\frac{\prod_{k=0,k\neq j}^n (x-x_k) }{\prod_{k=0,k\neq j}^n (x_j-x_k) } \end{align}$$ 

### 拉格朗日插值函数

$n$次的拉格朗日插值多项式，记作$L_n(x)$。很明显，这个多项式可以由前面的基函数累加而成：
$$
\begin{align}L_n(x)&=y_0l_0(x)+y_1l_1(x)+y_2l_2(x)+...+y_nl_n(x)\\&=\sum_{k=0}^n y_kl_k(x)\\\end{align}
$$
在《数值分析》第五版的课本上，引入了记号$w_{n+1}(x)=(x-x_0)(x-x_1)...(x-x_n)$，容易求得$w_{n+1}'(x_k)=(x_k-x_0)(x_k-x_1)...(x_k-x_{k-1})(x_k-x_{k+1})...(x_k-x_n)$，于是把$L_n(x)$记作：
$$
L_n(x)=\sum_{k=0}^{n}y_k\frac{w_{n+1}(x)}{(x-x_k)w_{n+1}'(x_k)}
$$

### 拉格朗日插值法的性质

在证明题中比较多用到这个性质。

**性质1**  拉格朗日基函数的和总是常函数1。
$$
\sum_{k=0}^n l_k(x)=1
$$
这个其实是非常显然的。因为构造的时候，就保证了每个插值项仅仅在一个插值节点上为1，其他都是0。除此之外，我们从基函数的构造也可以看出来，基函数仅和所有插值节点$x_i$有关，和$y_i$无关。当插值节点已知时，这一组基函数是确定的。那么，对于任意一组$x_0$、$x_1$、...、$x_n$，我们不妨假设$y_0=y_1=y_2=...=y_n=1$，这时候明显有$L_n(x)=1$，而根据$L_n(x)=y_0l_0(x)+y_1l_1(x)+...+y_nl_n(x)$，代入上面两个式子，有$l_0(x)+l_1(x)+...+l_n(x)=1$，证毕。

这个结论在后面进一步优化中会用到。

**性质2**  每个插值节点，都有
$$
\begin{cases}
&l_j(x_j)=1&\\
&l_j(x_m)=0&m\neq j
\end{cases}
$$


### 质心公式优化

拉格朗日插值的解决方法的确很直观，但是它也有劣势，它是$n+1$个$n+1$次多项式的叠加，计算复杂度达到$O(n^2)$，加入一个点后，更新一个点要重新计算，这确实不优，不过，这个方法可以一定程度上优化。

前面我们知道，有
$$
\begin{align}
l_j(x)=\frac{\prod _{k=0,k\neq j}^{n} (x-x_k) }{\prod _{k=0,k\neq j}^{n} (x_j-x_k) } \\
\end{align}
$$
我们可以观察发现，对于每一个插值基函数，它们在分子中都有很大一部分是相似的，只是每一个基函数缺少的$(x-x_j)$不同，那么，我们设公共的$l(x)=(x-x_0)(x-x_1)...(x-x_n)$，再除以$(x-x_j)$，就得到了每个基函数的分子部分。对于分母常数部分，因为每个基函数的常数都不同，我们简单记录为$w_j$。

$$w_j=\frac{1}{\prod _{k=0,k\neq j}^n(x_j-x_k)} $$

将插值函数化简，得到：

$$\begin{align}
l_j(x)&=\frac{\prod _{k=0,k\neq j}^{n} (x-x_k) }{\prod _{k=0,k\neq j}^{n} (x_j-x_k) } \\
&=w_j \cdot \frac{l(x)}{(x-x_j)}
\end{align}$$

这样，我们插值函数中，就可以提取出每个基函数的公共部分了：

$$\begin{align}
L_n(x)&=\sum_{k=0}^n y_kl_k(x)\\
&=l(x)\sum _{j=0}^n y_j\cdot\frac{w_j}{x-x_j}
\end{align}$$

考虑进一步化简，将上述式子除以前面说的基函数和为1，化简中校区同类项，略过化简过程，我们可以得到公式：

$$\begin{align}
L_n(x)&=\frac{\sum _{j=0}^{n}\frac{w_j}{x-x_j}y_j }{\sum _{j=0}^n\frac{w_j}{x-x_j} } \\
\end{align}$$

这个公式被称为质心公式（Barycentric formula）。

在每增加一个$x_n$时，我们可以$O(n)$地更新每个$w_j$，然后就可以$O(n)$地计算出任意的$L_n(x)$了。

### 误差分析

我们的观测值通常是从一个未知函数$f(x)$上采样得到的，这和插值函数之间的余项就是误差。一个常用公式是
$$
R_n(x)=f(x)-L_n(x)=\frac{f^{(n+1)}(\xi )}{(n+1)!}w_{n+1}(x)
$$
这里的$w_{n+1}(x)=(x-x_0)(x-x_1)...(x-x_n)$

这里的$\xi\in(a,b)$不太好确定，但是一般来说，能通过求出$f^{(n+1)}(x)$在$(a,b)$内的界，得到截断误差的界。

------

**例题**：设$x_j$为互异节点$(j=0,1,2,...,n)$，求证：
$$
\sum_{j=0}^n (x_j-x)^k l_j(x)\equiv 0& (k=1,2,...,n)\\
$$
证明：因为$(x_j-x)^k$中带了个未知数$x$，所以尝试拆分一下，把插值节点拆出去和基函数合并。
$$
(x_j-x)^k=\sum_{i=0}^{k}\binom{k}{i}(x_j)^i(-x)^{k-i}
$$
代入整理，即证
$$
\sum_{j=0}^n \left[\sum_{i=0}^{k}\binom{k}{i}(x_j)^i(-x)^{k-i}\right] l_j(x)\equiv 0\\
$$
面对这一大块，考虑利用一个性质，也就是拉格朗日插值法拟合$f(x)=x^n$这种函数，在一定情况下是可以没有误差的，$f(x)=L(x)$。

因此整理
$$
\begin{aligned}
&\sum_{i=0}^{k}\binom{k}{i}(-x)^{k-i}\sum_{j=0}^n(x_j)^il_j(x)\\
&=\sum_{i=0}^{k}\binom{k}{i}(-x)^{k-i}L(x)\\
&=\sum_{i=0}^{k}\binom{k}{i}(-x)^{k-i}x^i\\
&=(x-x)^k\\
&=0
\end{aligned}
$$
得证。



**例题**：设$f(x)\in C^2[a,b]$且$f(a)=f(b)=0$，求证：
$$
\max_{a\leq x\leq b}|f(x)|\leq \frac{1}{8}(b-a)^2 \max_{a\leq x\leq b} |f''(x)|
$$
思路：因为$f(x)\in C^2[a,b]$，所以用二次多项式来拟合无误差。但是这里实际上只有两个节点不够做二次拟合，那就只能用线性拟合加上余项。
$$
L(x)=\frac{f(a)(x-b)}{(a-b)}+\frac{f(b)(x-a)}{b-a}+R(x)\\
=R(x)
$$
得到
$$
\begin{aligned}
R(x)&=\frac{f^{(2)}(\xi )}{2!}(x-a)(x-b)\\
\end{aligned}
$$
由于$f(x)\in C^2[a,b]$可知，$f^{(2)}(\xi )$是一个非零常数。
$$
\begin{aligned}
\max_{a\leq x\leq b}|f(x)|=& \max_{a\leq x\leq b}|\frac{f^{(2)}(\xi )}{2!}(x-a)(x-b)|\\
\leq&\max_{a\leq x\leq b}|\frac{f^{(2)}(\xi )}{2!}\cdot\frac{(b-a)^2}{4}|\\
=& \frac{(b-a)^2}{8}\max_{a\leq x\leq b} |f^{(2)}(\xi)|\\
\leq & \frac{(b-a)^2}{8}\max_{a\leq x\leq b} |f''(x)|
\end{aligned}
$$
得证。

------



## 二. 牛顿插值法

### 思路

拉格朗日插值法，每一个基函数都用到了几乎所有的插值节点，这也就是说，如果每次多加一个插值节点，就需要全部重新计算，这在动态插点时不太优。例如在路径规划中，如果需要根据前面的情况，动态地加入节点，然后更新插值函数线，这时候时间复杂度就很坏了。

牛顿插值是为了避免拉格朗日插值每次都需要重新计算而产生的。我们期望实现一个插值算法，在每次插入一个新的插值节点时，都能在前面插值函数的基础上，通过直接加上一个新的基函数来构造新的插值函数。

在当前仅有一个节点$(x_0,y_0)$的时候，插值多项式显然是常数：$L_0(x)=l_0(x)=y_0$

<iframe src="https://www.desmos.com/calculator/izcp1ht9e5?embed" width="300" height="300" style="border: 1px solid #ccc" frameborder=0></iframe>

在加入第二个节点$(x_1,y_1)$时，插值多项式需要插入（或者说加上）一个新的基函数，因为不能影响前面的在$x_0$处的值（仍然必须为$y_0$），因此这个应该被加上的基函数要过$(x_0,0)$。为了保证过这个点，很显然构造基函数时，可以直接包含商$(x-x_0)$这一项。除了$(x-x_0)$这一项呢？因为插值函数$L_1(x)$必须要过$(x_1,y1)$，而前面的$L_0(x)$在$x=x_1$时表现为$y_0$，那么我们这个应该被加上的基函数，就应该在$x=x_1$时，填补出不够的差值，使得相加后能够表现为$y_1$，也就是说，这个第二个基函数除了要通过$(x_0,0)$外，还应该通过$(x_1,y_1-y_0)$。

（如下图，黑色的是最后累加出来的插值函数，红色和橙色是两个基函数。）

<iframe src="https://www.desmos.com/calculator/xaaobwyzbq?embed" width="300" height="300" style="border: 1px solid #ccc" frameborder=0></iframe>

由上述两个条件，构造出应该被加上的基函数$l_1(x)=\frac{y_1-y_0}{x_1-x_0}(x-x_0)$。这样一来，过两个点的插值函数就有了：

$$L_1(x)=l_0(x)+l_1(x)=y_0+\frac{y_1-y_0}{x_1-x_0}(x-x_0)$$

再加上第三个点$(x_2,y_2)$呢？同理，我们知道这个新加上的基函数应该过$(x_0,0)$、$(x_1,0)$，以及$(x_2,y2-L_1(x_2))$。那么这个$l_2(x)$就应该包含$(x-x_0)$、$(x-x_1)$，以及一个因子$\frac{y_2-L_1(x_2)}{(x_2-x_0)(x_2-x_1)}$。以此类推，这就是牛顿插值法的大致思路。

<iframe src="https://www.desmos.com/calculator/5mnskvtf4s?embed" width="500" height="500" style="border: 1px solid #ccc" frameborder=0></iframe>



举个例子，要求求二次多项式$f(x)$满足，$f(1)=-2$，$f(2)=-1$，$f(3)=2$。

首先处理$f(1)=-2$，$f(x)=-2$。
然后加点$f(2)=-1$，$f(x)=-2+a(x-1)$，解出来$a=1$，则有$f(x)=-2+(x-1)$。
然后加点$f(3)=2$，$f(x)=-2+(x-1)+b(x-1)(x-2)$，同样的，$b=1$，因此得到$f(x)=-2+(x-1)+(x-1)(x-2)$

### 差商？

如何快速写出牛顿迭代法的递推公式？

重新观察一下牛顿迭代法，每一个牛顿插值多项式$N_{k+1}(x)$，都可以从低阶的$N_{k}(x)$递推出来：
$$
N_{k+1}(x)=N_{k}(x)+\Delta\times(x-x_0)(x-x_1)...(x-x_k)
$$
后面那一串$(x-x_0)(x-x_1)...(x-x_k)$，保证了新增的这一项，不影响前面插值的结果。这里的$\Delta$，是一个缩放常数， 它要保证在$x=x_{k+1}$的时候，后面那个新增的项能提供恰好的增量，使得整个式子达到$y_{k+1}$。

如何控制这个$\Delta$？这里就可以引入差商的概念。这个缩放因子，实际上就是差商。

在计算两个点的直线斜率的时候，在高中数学中有$k=\frac{f(x_0)-f(x_1)}{x_0-x_1}$，这实际上就是一阶差商。

一阶差商：$f[x_0,x_1]=\frac{f(x_0)-f(x_1)}{x_0-x_1}$

二阶差商：$f[x_0,x_1,x_2]=\frac{f[x_0,x_1]-f[x_1,x_2]}{x_0-x_2}$

三阶差商：$f[x_0,x_1,x_2,x_3]=\frac{f[x_0,x_1,x_2]-f[x_1,x_2,x_3]}{x_0-x_3}$

<a href="https://imgse.com/i/pktHFxK"><img src="https://s21.ax1x.com/2024/06/08/pktHFxK.png" alt="pktHFxK.png" border="0" /></a>

牛顿插值多项式，由上述差商与一系列基函数构成。重新观察牛顿多项式，发现可以写作：

$$\begin{align}
N_n(x)&=f(x_0)+f[x_0,x_1](x-x_0)+f[x_0,x_1,x_2](x-x_0)(x-x_1)...+f[x_0,x_1,...,x_n](x-x_0)(x-x_1)...(x-x_{n-1})\\
&=f(x_0)+...+f[x_0,x_1,...,x_n]\prod _{k=0}^{n-1}(x-x_k)
\end{align}$$

理解上可以视为，差商实际上构造了一个针对这组插值节点的$k$阶导数，所以直接用差商作为缩放因子，就能把$N_k(x)$在$x=x_k$上补到$y_k$。



 ### 差商（均差）的性质

$$
f[x_0,...,x_k]=\sum_{j=0}^k\frac{f(x_j)}{(x_j-x_0)...(x_j-x_{j-1})(x_j-x_{j+1})...(x_j-x_k)}
$$

$$
f[x_0,...,x_k]=\frac{f[x_0,...,x_{k-2},x_k]-f[x_0,...x_{k-1}]}{x_k-x_{k-1}}
$$

① 差商具有对称性，它和节点序列的排列次序无关。基于对称性，可以得到改进的递推式
$$
f[x_0,...,x_k]=\frac{f[x_1,...,x_k]-f[x_0,...,x_{k-1}]}{x_k-x_0}
$$
② 与$n$阶导的关系
$$
f[x_0,x_1,...,x_n]=\frac{f^{(n)}(\xi)}{n!},& \xi\in[a,b]\\
$$

### 误差分析

构造出来的插值函数与原函数存在误差，作误差余项
$$
R_n(x)=f(x)-P_n(x)
$$
和拉格朗日的余项意义上是一样的。拉格朗日的余项是
$$
R_n(x)=\frac{f^{(n+1)}(\xi )}{(n+1)!}w_{n+1}(x)
$$
而牛顿插值法的余项，可以通过差商的方式，写作
$$
R_n(x)=f[x,x_0,...,x_n]w_{n+1}(x)
$$
已知，$R_n(x_0)=R_n(x_1)=...=R_n(x_n)=0$，由罗尔定理，知道任意两个相邻节点之间，$R_n(x)$至少存在一个零导数点，整个区间上，就会有至少$n$个点使得$R_n^{(1)}(x)=0$。同理，重复应用罗尔定理，很显然会知道，$R_n^{(n)}(x)$在这段区间上，会有至少一个点等于0，设这个点为$x=\xi$。由$R_n^{(n)}(x)=f^{(n)}(x)-P_n^{(n)}(x)$，得到在该点有$f^{(n)}(\xi)=P^{(n)}_n(\xi)$。

回头再看看$P_n(x)$，这个是我们已知的，
$$
P_n(x)=f(x_0)+f[x_0,x_1](x-x_0)+f[x_0,x_1,x_2](x-x_0)(x-x_1)...\\+f[x_0,x_1,...,x_n](x-x_0)(x-x_1)...(x-x_{n-1})
$$
在进行$n$阶导后，只有最后一项保留，$P_n^{(n)}(x)=f[x_0,x_1,...,x_n](n!)$

在$x=\xi$点，由于$f^{(n)}(\xi)=P^{(n)}_n(\xi)$，那么可以知道，$f^{(n)}(\xi)=f[x_0,x_1,...,x_n](n!)$

得到结论：在$R_n^{(n)}(\xi)=0$，则$f[x_0,x_1,x_2,...,x_n]=\frac{f^{(n)(\xi)}}{n!}$



### 差分形式的牛顿插值

已知拉格朗日插值法和牛顿插值法，对节点位置都没有任何要求。但是实际问题中，比较多的是节点之间等距的插值问题，能不能针对这种形式的问题，对算法做简化？

（有空写这个）



## 三. 埃尔米特插值

牛顿插值是知道$n+1$个点，求多项式。而泰勒公式是知道某个点的信息，作展开。有没有公式可以合二为一？这就是埃米尔特插值法。

埃米尔特插值法可以用来解决一些问题：对于一些点，我们知道函数值，而其他的点，我们知道导数值。这时候如果用朴素的牛顿插值，就比较棘手。但是我们可以用类似牛顿插值的方式，找到多项式，然后将相同的用泰勒系数替代。

### 重节点均差

对于重节点，实际上也是有均差定义的
$$
f[x_0,x_0]=f'(x_0)
$$
类似的，推广到重节点的$n$阶均差
$$
f[x_0,x_0,...,x_0]=\frac{1}{n!}f^{(n)}(x_0)\\
(一共有(n+1)个x_0)
$$

### 待定系数法（函数值和导数值个数不同）

这种问题，我们一般先用牛顿插值法，获得到符合函数值要求的多项式，然后追加一项不影响前面约束的项，然后求解系数。什么是不影响前面约束的项？例如给定的条件，已经能求解出
$$
P(x)=f(x_0)+f[x_0,x_1](x-x_0)+f[x_0,x_1,x_2](x-x_0)(x-x_1)
$$
但是如果进一步约束了某个点的导数值呢？这时候，我们可以添加一项
$$
P(x)=f(x_0)+f[x_0,x_1](x-x_0)+f[x_0,x_1,x_2](x-x_0)(x-x_1)\\
+A(x-x_0)(x-x_1)(x-x_2)
$$
因为我们插入的$(x-x_0)(x-x_1)(x-x_2)$在前面插值节点上表现都是0，所以是不影响函数值计算结果的，但是我们可以通过这个来实现对导数值的约束。

具体的，以这题为例。

给定函数$f(x)=x^{3/2}$，$x_0=\frac{1}{4}$，$x_1=1$，$x_2=\frac{9}{4}$，试求$f(x)$在$[\frac{1}{4},\frac{9}{4}]$上的三次埃尔米特插值多项式$P(x)$，要求满足$P'(x_1)=f'(x_1)$，并写出余项表达式。

很明显，可以直接做一遍牛顿插值
$$
P(x)=\frac{1}{8}+\frac{7}{6}(x-\frac{1}{4})+\frac{11}{30}(x-\frac{1}{4})(x-1)
$$
然后，因为要求$P'(x_1)=f'(x_1)$，所以考虑加入一个不影响前面函数值的项，也就是
$$
P(x)=\frac{1}{8}+\frac{7}{6}(x-\frac{1}{4})+\frac{11}{30}(x-\frac{1}{4})(x-1)+A(x-\frac{1}{4})(x-1)(x-\frac94)
$$
然后因为$P'(1)=f'(1)=\frac32$，对$P(x)$求导
$$
P'(x)=\frac{7}{6}+\frac{11}{30}\times (2x-\frac54)+A[(x-\frac{1}{4})(x-1)(x-\frac94)]'
$$

$$
\begin{aligned}
P'(1)&=\frac{7}{6}+\frac{11}{30}\times (2-\frac54)+A(1-\frac14)(1-\frac94)=\frac32\\
A&=-\frac{14}{225}
\end{aligned}
$$

然后要求余项
$$
\begin{aligned}
R(x)&=\frac{f^{(4)}(\xi)}{4!}(x-\frac14)(x-1)^2(x-\frac94)\\
&(注意这里(x-1)^2是二次的，因为要求在x=1处可导)\\
\end{aligned}
$$

### 典型埃尔米特插值

这里还是多项式插值，$n+1$个插值节点。但是我们又增加了$n+1$个对导数值的约束（也就是说，对每个节点都约束导数值），这时候，多项式次数增加到了$2n+1$次。这时候的插值思想和拉格朗日类似，我们用两组基函数$\alpha$和$\beta$，其中$\alpha_j(x)$保证了节点$x_k$上插值多项式的函数值正好是$f(x_k)$，而$\beta_j(x)$则保证了节点$x_k$上的导数值正好是$f'(x_k)$
$$
\alpha_j(x_k)=\begin{cases}
0&j\neq k\\
1&j=k
\end{cases}\\
\alpha_j'(x_k)=0（这样才能不影响导数值）
$$

$$
\beta_j(x_k)=0（这样才能不影响函数值）\\
\beta_j'(x_k)=\begin{cases}
0&j\neq k\\
1&j=k
\end{cases}\\
$$

获得了构成上述条件的插值基函数后，可以构造出插值多项式
$$
H_{2n+1}(x)=\sum_{j=0}^n \left[y_j\alpha_j(x)+m_j\beta _j(x)\right]
$$
这里，$H(x_j)=y_j,H'(x_j)=m_j$

如何构造出满足上述条件的$\alpha$和$\beta$？

首先来看$\alpha_j(x_k)$，对$\alpha_j(x_k)$的函数值的约束，可以直接用拉格朗日插值来实现，也就是$\alpha_j(x_k)=l_j(x)$，但是这明显不符合导数值为0的要求，需要进行调整，使得它满足导数值为0。如何调整？

典型的埃尔米特插值公式是
$$
\alpha_j(x)=\left(1-2(x-x_j)\sum_{k=0,k\neq j}^n \frac{1}{x_j-x_k}\right)l_j^2(x)\\
\beta_j(x)=(x-x_j)l_j^2(x)
$$

