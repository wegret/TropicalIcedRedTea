[TOC]



# 解线性方程组的直接方法

## 引入

在线性代数中，实际上已经学过了朴素的解线性方程组的做法。

## 一. 高斯消去法

### 朴素的高斯消去法

高斯消去法，实际上就是经过一系列行变换，将$AX=b$方程，化为$A^{(n)}X=b^{(n)}$，形如下面的过程
$$
A^{(n)}=L_{n-1}...L_2L_1A\\
b^{(n)}=L_{n-1}...L_2L_1b\\
这里的L_i是第三类初等行变换，也就是以数 𝑘 乘某行加到另一行上去
$$
这里的$L_i$实际上都是单位下三角矩阵。（单位下三角矩阵一般定义为一个主对角线元素全为1，下三角元素可以是任意数值的矩阵）

形如
$$
L = \begin{pmatrix}
1 &  &  &  &  & \\
 & 1 &  &  & & \\
 &  & 1 &  &  &\\
 &  & \vdots & \ddots &  &\\
 &  & k & \cdots & 1 &\\
  &  &  &  &  & \ddots\\
\end{pmatrix}
$$
左乘这个$L$，就是把矩阵的第$j$行加上了第$i$行的$k$倍。
$$
R_{ij}(k)A = 
\begin{pmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
\vdots & \vdots & & \vdots \\
a_{i1} & a_{i2} & \cdots & a_{in} \\
\vdots & \vdots & & \vdots \\
a_{j1} + k a_{i1} & a_{j2} + k a_{i2} & \cdots & a_{jn} + k a_{in} \\
\vdots & \vdots & & \vdots \\
a_{m1} & a_{m2} & \cdots & a_{mn}
\end{pmatrix}
$$
很显然，这个$L$的逆矩阵，只需要将第$j$行减去第$i$行的$k$倍即可，即
$$
L^{-1} = \begin{pmatrix}
1 &  &  &  &  & \\
 & 1 &  &  & & \\
 &  & 1 &  &  &\\ 
 &  & \vdots & \ddots &  &\\
 &  & -k & \cdots & 1 &\\
  &  &  &  &  & \ddots\\
\end{pmatrix}
$$
这还是单位下三角矩阵。

最终我们得到的$A^{(n)}$，通常会变成上三角矩阵，解通过回代得到。
$$
\begin{pmatrix}
a_{11}^{(1)} & a_{12}^{(1)} & \cdots & a_{1n}^{(1)} \\
& a_{22}^{(2)} & \cdots & a_{2n}^{(2)} \\
& & \ddots & \vdots \\
& & & a_{nn}^{(n)}
\end{pmatrix}
\begin{pmatrix}
x_1 \\
x_2 \\
\vdots \\
x_n
\end{pmatrix}
=
\begin{pmatrix}
b_{1}^{(1)} \\
b_{2}^{(2)} \\
\vdots \\
b_{n}^{(n)}
\end{pmatrix}
$$

### 高斯主元素消去法

朴素的高斯消去法实际用来解方程是比较简单的。但是在具体进行高斯消元的时候，我们会发现，其中有一步，我们往往需要对$j$行进行消去第一列的元，也就是减去第$i$行首元素的$k$倍。这时候如果第$i$行首元素太小（或者甚至是0），那么这里的$k$就会很大，在实际编程中可能会导致溢出或者精度下降。为了提高数值稳定性，我们会希望尽可能让主元元素（第$i$行首元素）的绝对值尽可能大。

如何做？我们只需要适当做一些变换即可，这就是**选主元高斯消去法**。根据挑选“主元”的范围分成两类：列主元高斯消去法、全主元高斯消去法．

#### 列主元高斯消去法（Partial Pivoting）

列主元高斯消去法是在每一步消去过程中，通过交换行，使得每列的主元的绝对值尽可能大。

在进行第 $k$ 步消去时，从第 $k$ 列中选择绝对值最大的元素作为主元。这个元素的位置可能在第 $k$ 行或之后的任何一行中。将包含该主元的行与第$k$行交换。然后继续使用朴素的高斯消去法，将第$k$行以下所有行的第$k$列的元素消去。

#### 全主元高斯消去法（Full Pivoting）

全主元高斯消去法不仅在列中选择主元，还在整个剩余的子矩阵中选择主元。

在进行第$k$步消去时，从剩余的 $(n−k+1)\times (n-k+1)$ 子矩阵中选择绝对值最大的元素作为主元。这个元素的位置可以在第$k$行、第$k$列或之后的任何行列中。将包含该主元的行与第 $k$ 行交换，同时将包含该主元的列与第 $k$ 列交换。

然后使用标准的高斯消去法消去即可。

------

**例题**：设$A=(a_{ij})_{n}$是对称正定矩阵，经过高斯消去法一步后，$A$ 约化为
$$
\left ( \begin{matrix} a_{11} & a_{1}^{T} \\ 0 & A_{2} \end{matrix} \right )
$$
 其中$A_{2}=(a_{ij}^{(2)})_{n-1}$。证明： 

（1）$A$ 的对角元素$a_{ii}>0,\ i=1,2,\cdots,n$; 

（2）$A_{2}$是对称正定矩阵。 

证明：（1）由$A$对称正定，得
$$
X^TAX>0\\
$$
任意代入$X_1=[1,0,...,0]$，$X_2=[0,1,0,...,0]$……

容易证明$a_{ii}>0$。

（2）可以写出初始的$A$
$$
A=\left ( \begin{matrix} a_{11} & a_{1}^{T} \\ a_1 & A_{1} \end{matrix} \right )
$$
高斯消元时，
$$
a_{ij}^{(2)}=a_{ij}-\frac{a_{j1}}{a_{11}}a_{1i}=a_{ji}^{(2)}
$$
因此对称。

正定性略了。

------

## 二. 矩阵三角分解：直接分解法

前面我们知道，高斯消去法的过程是这样的
$$
A^{(n)}=L_{n-1}...L_2L_1A\\
b^{(n)}=L_{n-1}...L_2L_1b\\
$$
这里的$L$一般都是下面这样的矩阵
$$
L = \begin{pmatrix}
1 &  &  &  &  & \\
 & 1 &  &  & & \\
 &  & 1 &  &  &\\ 
 &  & \vdots & \ddots &  &\\
 &  & k & \cdots & 1 &\\
  &  &  &  &  & \ddots\\
\end{pmatrix}
$$

高斯消去法，实际上就是将$A$化为上三角矩阵$U$，而对它做变换的$L$和$L$的逆都是下三角矩阵，因此可以写作
$$
A=LU
$$
而带交换的列主元消去法，也就是多加了个交换步骤
$$
PA=LU
$$
由此想到，有什么办法能直接求出$L$和$U$吗？只要能直接求出$L$和$U$，求解$AX=b$就等价于求解这个方程
$$
LY=b\\
UX=Y
$$
可以看出这个方程因为都是上下三角，所以是非常好解的，这就是三角分解。

### Doolittle分解法

Doolittle分解法，有点类似于一个待定系数逐个分解的办法。

假设我们有这样一个矩阵
$$
A=\begin{bmatrix}
2&3&1\\
4&7&1\\
2&1&3
\end{bmatrix}
$$
初始化时，我们先设结果为
$$
L=\begin{bmatrix}
1&&\\
0&1&\\
0&0&1
\end{bmatrix},U=\begin{bmatrix}
0&0&0\\
&0&0\\
&&0
\end{bmatrix}
$$
这时候$LU=0$

先处理$A$的第一行。

先看$A$的第一行第一列的元素，要让$LU=A$，要求$L$的第一行对乘$U$的第一列，等于$2$。因为$U$是上三角，第一列除了第一个元素都是0，因此我们直接让$U_{11}=2$
$$
L=\begin{bmatrix}
1&&\\
0&1&\\
0&0&1
\end{bmatrix},U=\begin{bmatrix}
2&0&0\\
&0&0\\
&&0
\end{bmatrix}
$$
然后再来考虑$A$的第一行第二列的元素，这个也是同理，因为$L$是下三角第一行只有一个有效元素嘛，所以我们很快能判断$U_{12}=3,U_{13}=1$
$$
L=\begin{bmatrix}
1&&\\
0&1&\\
0&0&1
\end{bmatrix},U=\begin{bmatrix}
2&3&1\\
&0&0\\
&&0
\end{bmatrix}
$$
这时候
$$
L\times U=\begin{bmatrix}
1&&\\
0&1&\\
0&0&1
\end{bmatrix}\begin{bmatrix}
2&3&1\\
&0&0\\
&&0
\end{bmatrix}=\begin{bmatrix}
2&3&1\\
&&\\
&&
\end{bmatrix}
$$
我们已经拼凑完成$A$的第一行了。接下来来看第二行。首先是第二行第一列元素$4$，怎么表现出来？这是$L$的第二行乘以$U$的第一列。因为$U$的第一列只有一个元素$2$，所以我们很快就能判断，$L_{21}=2$，只有这样，才能表现出第一个元素$4$。
$$
L\times U=\begin{bmatrix}
1&&\\
2&1&\\
0&0&1
\end{bmatrix}\begin{bmatrix}
2&3&1\\
&0&0\\
&&0
\end{bmatrix}=\begin{bmatrix}
2&3&1\\
4&&\\
&&
\end{bmatrix}
$$
然后看$A$的第二行第二列元素$7$，同理，我们直接给$U_{21}$填上$1$
$$
L\times U=\begin{bmatrix}
1&&\\
2&1&\\
0&0&1
\end{bmatrix}\begin{bmatrix}
2&3&1\\
&1&0\\
&&0
\end{bmatrix}=\begin{bmatrix}
2&3&1\\
4&7&\\
&&
\end{bmatrix}
$$
同理，看$A$的第二行第三列元素$1$，直接给$U_{23}$填上$-1$
$$
L\times U=\begin{bmatrix}
1&&\\
2&1&\\
0&0&1
\end{bmatrix}\begin{bmatrix}
2&3&1\\
&1&-1\\
&&0
\end{bmatrix}=\begin{bmatrix}
2&3&1\\
4&7&1\\
&&
\end{bmatrix}
$$
第三行同理，我们很快就能填写完毕：
$$
L\times U=\begin{bmatrix}
1&&\\
2&1&\\
1&-2&1
\end{bmatrix}\begin{bmatrix}
2&3&1\\
&1&-1\\
&&0
\end{bmatrix}=\begin{bmatrix}
2&3&1\\
4&7&1\\
2&1&3
\end{bmatrix}=A
$$
分解完毕！

### Crout分解法

Crout分解法，思路和Doolittle几乎一致，只不过初始的单位矩阵变成了$U$。其余计算过程类似。

### 适用条件

这两种算法都被称为直接分解法。什么时候适用呢？有一个定理。

**定理**    $n$阶矩阵$A$有唯一的Doolittle分解或Crout分解的充要条件是：$A$的顺序主子式$A_i$ $(i=1,2, ..., n-1)$非奇异．

## 三. 特殊条件下的分解法

对于一些具有很妙的性质的方程组，有一些更好的方法。

### 对称正定阵

#### 平方根法

由对称正定矩阵的性质知道
$$
A=LL^T
$$
如果要求$L$的对角矩阵均为正，这个分解是唯一的。

例如，如果用平方根法分解
$$
A=\begin{bmatrix}
1&2&3\\
2&6&10\\
3&10&20
\end{bmatrix}
$$
同理，先写出$L_{11}$
$$
L\times U=\begin{bmatrix}
1&&\\
0&0&\\
0&0&0
\end{bmatrix}\begin{bmatrix}
1&0&0\\
&0&0\\
&&0
\end{bmatrix}=\begin{bmatrix}
1&&\\
&&\\
&&
\end{bmatrix}
$$
然后第一列第二行
$$
L\times U=\begin{bmatrix}
1&&\\
2&\sqrt 2&\\
3&2\sqrt 2&\sqrt 3
\end{bmatrix}\begin{bmatrix}
1&2&3\\
&\sqrt 2&2\sqrt 2\\
&&\sqrt 3
\end{bmatrix}
$$
但是朴素的平方根法，求解时，也需要计算$n$个数的开方，有没有办法不开方的？

#### 改进平方根法

**定理**    设$A$为$n$阶对称阵，且$A$的所有顺序主子式均不为0，则$A$可以唯一分解为
$$
A=LDL^T
$$
其中$L$为单位下三角阵，$D$为对角阵。

有了这个性质后，求解也非常简单，从下三角我们可以很方便求出来$LY=b$，然后求$L^TX=D^{-1}Y$即可求解。
